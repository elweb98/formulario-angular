<div class="form-card">
  <h2>Formulário do Elias</h2>

  <div class="steps">
    <div class="step" [class.active]="currentStep === 1">1. Dados básicos</div>
    <div class="step" [class.active]="currentStep === 2">2. Informações profissionais</div>
    <div class="step" [class.active]="currentStep === 3">3. Endereço</div>
  </div>

  <form [formGroup]="form" novalidate *ngIf="!showSummary">
    <div class="step-panel" *ngIf="currentStep === 1" formGroupName="basic">
      <fieldset [disabled]="form.get('basic')?.disabled">
        <legend>Dados básicos</legend>

        <label>
          Nome completo*
          <input formControlName="fullName" />
          <small class="error" *ngIf="form.get('basic.fullName')?.invalid && form.get('basic.fullName')?.touched">
            Campo obrigatório.
          </small>
        </label>

        <label>
          E-mail*
          <input formControlName="email" />
          <small class="error" *ngIf="form.get('basic.email')?.hasError('required') && form.get('basic.email')?.touched">
            Campo obrigatório.
          </small>
          <small class="error" *ngIf="form.get('basic.email')?.hasError('email') && form.get('basic.email')?.touched">
            E-mail inválido.
          </small>
        </label>

        <label>
          Telefone*
          <input formControlName="phone" />
          <small class="error" *ngIf="form.get('basic.phone')?.invalid && form.get('basic.phone')?.touched">
            Campo obrigatório.
          </small>
        </label>
      </fieldset>
    </div>

    <div class="step-panel" *ngIf="currentStep === 2" formGroupName="professional">
      <fieldset [disabled]="form.get('professional')?.disabled">
        <legend>Informações profissionais</legend>

        <label>
          Cargo pretendido*
          <input formControlName="position" />
          <small class="error" *ngIf="form.get('professional.position')?.invalid && form.get('professional.position')?.touched">
            Campo obrigatório.
          </small>
        </label>

        <label>
          Pretensão salarial*
          <input type="number" formControlName="salaryExpectation" />
          <small class="error" *ngIf="form.get('professional.salaryExpectation')?.invalid && form.get('professional.salaryExpectation')?.touched">
            Valor deve ser positivo.
          </small>
        </label>

        <fieldset class="radio-group">
          <legend>Possui experiência na área?*</legend>
          <label><input type="radio" value="sim" formControlName="hasExperience" /> Sim</label>
          <label><input type="radio" value="nao" formControlName="hasExperience" /> Não</label>
          <small class="error" *ngIf="form.get('professional.hasExperience')?.invalid && form.get('professional.hasExperience')?.touched">
            Campo obrigatório.
          </small>
        </fieldset>
      </fieldset>
    </div>

    <div class="step-panel" *ngIf="currentStep === 3" formGroupName="address">
      <fieldset [disabled]="form.get('address')?.disabled">
        <legend>Endereço</legend>

        <label>
          CEP*
          <input formControlName="cep" />
          <small class="error" *ngIf="form.get('address.cep')?.invalid && form.get('address.cep')?.touched">
            Campo obrigatório.
          </small>
        </label>

        <label>
          Logradouro*
          <input formControlName="street" />
          <small class="error" *ngIf="form.get('address.street')?.invalid && form.get('address.street')?.touched">
            Campo obrigatório.
          </small>
        </label>

        <label>
          Cidade*
          <input formControlName="city" />
          <small class="error" *ngIf="form.get('address.city')?.invalid && form.get('address.city')?.touched">
            Campo obrigatório.
          </small>
        </label>

        <label>
          UF* (2 letras)
          <input maxlength="2" formControlName="uf" />
          <small class="error" *ngIf="form.get('address.uf')?.invalid && form.get('address.uf')?.touched">
            UF inválido ou obrigatório.
          </small>
        </label>
      </fieldset>
    </div>

    <div class="actions">
      <button type="button" (click)="prevStep()" *ngIf="currentStep > 1">← Voltar</button>
      <button type="button" (click)="nextStep()" [disabled]="currentGroup.invalid" *ngIf="currentStep < 3">Avançar →</button>
      <button type="button" (click)="submitForm()" [disabled]="currentGroup.invalid" *ngIf="currentStep === 3">Enviar</button>
    </div>
  </form>

  <div *ngIf="showSummary" class="summary">
    <h3>Resumo da candidatura</h3>

    <div class="summary-section">
      <h4>Dados básicos</h4>
      <p><strong>Nome:</strong> {{ form.value.basic.fullName }}</p>
      <p><strong>E-mail:</strong> {{ form.value.basic.email }}</p>
      <p><strong>Telefone:</strong> {{ form.value.basic.phone }}</p>
    </div>

    <div class="summary-section">
      <h4>Informações profissionais</h4>
      <p><strong>Cargo pretendido:</strong> {{ form.value.professional.position }}</p>
      <p><strong>Pretensão salarial:</strong> R$ {{ form.value.professional.salaryExpectation }}</p>
      <p><strong>Possui experiência:</strong> {{ form.value.professional.hasExperience | titlecase }}</p>
    </div>

    <div class="summary-section">
      <h4>Endereço</h4>
      <p><strong>CEP:</strong> {{ form.value.address.cep }}</p>
      <p><strong>Logradouro:</strong> {{ form.value.address.street }}</p>
      <p><strong>Cidade:</strong> {{ form.value.address.city }}</p>
      <p><strong>UF:</strong> {{ form.value.address.uf }}</p>
    </div>

    <button type="button" (click)="backToForm()">Voltar ao formulário</button>
  </div>
</div>